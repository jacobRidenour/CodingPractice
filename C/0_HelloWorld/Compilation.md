# Compilation

Basics of C program compilation using bare gcc and simple Makefiles.

## Single file program

See the [Options Summary for gcc](https://gcc.gnu.org/onlinedocs/gcc/Option-Summary.html) for more information.

```bash
gcc filename.c -g -Wall -Werror -Wcast-align=strict -Wpedantic -lm -o MyProg
```

| Flag | Category | Effect | 
| ---- | -------- | ------ | 
| `-g` | Debugging | include debugging information in the output |
| `-Wall` | Warnings | enable warnings for (often) suspicious/easy to avoid constructions |
| `-Werror` | Warnings | treat warnings as errors |
| `-Wcast-align=strict` | Warnings | enable warnings for pointer casts that increase the target's alignment (e.g. `int* <- char*`) |
| `-Wpedantic` | Warnings | enable warnings for usage of language extensions (not part of the ISO C/C++ standard) |
| `-lm`| Linker | `l`ink to library `m`; math library in this case.<br>Typical syntax to link to a specific library |
| `-o MyProg` | Output | Output should be a file called MyProg;<br>filename is `a.out` if not provided. |

## Multi-file program

```bash
# Create object files
gcc -c filename1.c -o filename1.o -I./include # -g -...
gcc -c filename2.c -o filename2.o -I./include # -g -...
# Link the object files together
gcc filename1.o filename2.o -o MyProg -L./lib -lm
```

| Flag | Category | Effect | 
| ---- | -------- | ------ | 
| `-c` | Compilation | compile translation unit (\*.c file) into object file (\*.o) |
| `-I ./include` | Include | include `./include` in the list of directories to search for header (\*.h) files;<br>may be repeated as necessary |
| `-L./lib` | Linker | include `./lib` in the list of directories to search for library files;<br>may be repeated as necessary |

For multi-file programs, it is best practice to create object files for each source file; this way, no time is wasted recompiling code that has not changed. This becomes more important with larger projects.

You could write a bash script to do the compilation for you, and adjust it manually as you add more files. Most typically, or maybe even canonically, for C programs the build will be automated using Make, which performs actions based on targets specified in a Makefile. For massive projects it is not uncommon to see Makefiles (or other build systems) be generated by some other program, as they can get complicated and difficult to maintain.

## Make basics

